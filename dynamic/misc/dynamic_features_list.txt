################################################################### all extracted features before feature selection/reduction - total 341 ###################################################################

api_categories = ['__notification__', 'netapi', 'synchronisation', 'exception', 'services', 'resource', 'certificate', 'ole', 'system', 'crypto', 'file', 'registry', 'ui', 'network', 'process', 'misc']

api_stats_list = ['NtCreateSection', 'InternetGetConnectedStateExA', 'LoadStringA', 'NtReadFile', 'DrawTextExA', 'WriteConsoleW', 'GetBestInterfaceEx', 'FindResourceExW', 'RegQueryValueExA', 'CopyFileW', 'DeleteFileW', 'DrawTextExW', 'CreateServiceA', 'OpenServiceA', 'GetVolumeNameForVolumeMountPointW', 'GetAdaptersAddresses', 'WriteConsoleA', 'CryptProtectMemory', 'WSAStartup', 'RegSetValueExW', 'sendto', 'CertOpenSystemStoreA', 'NtDeleteValueKey', 'SizeofResource', 'InternetGetConnectedState', 'CryptExportKey', 'StartServiceW', 'EnumServicesStatusA', 'SearchPathW', 'NtWriteFile', 'CoGetClassObject', 'CreateProcessInternalW', 'NtFreeVirtualMemory', 'UuidCreate', 'NtAllocateVirtualMemory', 'SetFileTime', 'CreateRemoteThreadEx', 'InternetQueryOptionA', 'GetKeyboardState', 'GetForegroundWindow', 'CertCreateCertificateContext', 'DnsQuery_W', 'HttpSendRequestA', 'RegEnumKeyW', 'RegEnumKeyExW', 'NtCreateFile', 'RegDeleteValueA', 'FindWindowExA', 'Process32FirstW', 'GetTimeZoneInformation', 'RtlCreateUserThread', 'SetErrorMode', 'CreateJobObjectW', 'RtlDecompressBuffer', 'CoInitializeSecurity', 'NtSetValueKey', 'SendNotifyMessageW', 'InternetCrackUrlA', 'CryptDecodeObjectEx', 'RegisterHotKey', 'NtDeleteKey', '__exception__', 'InternetOpenA', 'EnumServicesStatusW', 'NtEnumerateValueKey', 'GetCursorPos', 'IWbemServices_ExecQuery', 'NtMapViewOfSection', 'GetFileSizeEx', 'send', 'setsockopt', 'GetSystemTimeAsFileTime', 'GetTempPathW', 'CryptUnprotectMemory', 'NtOpenSection', 'GetSystemWindowsDirectoryA', 'recv', 'SetFileAttributesW', 'NtUnmapViewOfSection', 'NtSuspendThread', 'GetSystemDirectoryA', 'SetInformationJobObject', 'NtSetContextThread', 'ShellExecuteExW', 'NtClose', 'NtWriteVirtualMemory', 'NtQueryDirectoryFile', 'CryptHashData', 'InternetSetOptionA', 'FindWindowA', 'FindFirstFileExW', 'CopyFileExW', 'IsDebuggerPresent', 'AssignProcessToJobObject', 'LoadStringW', 'WSARecv', 'LookupPrivilegeValueW', 'NtQueryMultipleValueKey', 'RegDeleteKeyA', 'GetDiskFreeSpaceW', 'RegCreateKeyExA', 'NtOpenMutant', 'HttpOpenRequestW', 'NtQueryAttributesFile', 'MessageBoxTimeoutW', 'GetSystemInfo', 'NtTerminateProcess', 'gethostbyname', 'GetUserNameW', 'CoCreateInstance', 'GetComputerNameW', 'LookupAccountSidW', 'NtResumeThread', 'SetFilePointerEx', 'HttpOpenRequestA', 'select', 'RegEnumValueW', 'accept', 'GetSystemMetrics', 'InternetOpenUrlA', 'WSASocketW', 'LoadResource', 'CryptAcquireContextW', 'closesocket', 'IWbemServices_ExecMethod', 'RegCreateKeyExW', 'FindWindowW', 'WriteProcessMemory', 'CreateDirectoryExW', 'HttpQueryInfoA', 'OpenSCManagerW', 'GetUserNameA', 'NtGetContextThread', 'FindWindowExW', 'NtQueueApcThread', 'GetComputerNameA', 'RegQueryInfoKeyA', 'GetUserNameExA', 'GetNativeSystemInfo', 'LdrLoadDll', 'NtReadVirtualMemory', 'RegDeleteValueW', 'RegEnumValueA', 'GetAddrInfoW', 'RtlAddVectoredExceptionHandler', 'OpenSCManagerA', 'NetShareEnum', 'listen', 'RegSetValueExA', 'FindResourceExA', 'CoCreateInstanceEx', 'socket', 'InternetConnectW', 'NtQuerySystemInformation', 'GetFileInformationByHandleEx', 'CertControlStore', 'ObtainUserAgentString', 'SetFileInformationByHandle', 'SetFilePointer', 'CoUninitialize', 'CryptAcquireContextA', 'GetFileVersionInfoSizeExW', 'RegCloseKey', 'WSASocketA', 'TaskDialog', 'GetDiskFreeSpaceExW', 'NetUserGetInfo', 'NtQueryInformationFile', 'GetFileVersionInfoW', 'FindFirstFileExA', 'WSASendTo', 'InternetCloseHandle', 'GetVolumePathNameW', 'GetFileVersionInfoSizeW', 'recvfrom', 'GetFileInformationByHandle', 'Module32FirstW', 'NtQueryValueKey', 'OpenServiceW', 'LdrGetDllHandle', 'SetWindowsHookExA', 'NtDelayExecution', 'NtCreateThreadEx', 'GetFileSize', 'EnumWindows', 'NtTerminateThread', 'RtlAddVectoredContinueHandler', 'FindResourceW', 'bind', 'GetFileVersionInfoExW', 'GetKeyState', 'GlobalMemoryStatus', 'LdrGetProcedureAddress', 'StartServiceA', 'SendNotifyMessageA', 'InternetSetStatusCallback', 'NtOpenKeyEx', 'GetShortPathNameW', 'Thread32Next', 'WSARecvFrom', 'CreateToolhelp32Snapshot', 'RtlRemoveVectoredExceptionHandler', 'NtOpenFile', 'GetVolumePathNamesForVolumeNameW', 'OutputDebugStringA', 'RegOpenKeyExA', 'DeviceIoControl', 'MoveFileWithProgressW', 'NtEnumerateKey', 'shutdown', 'NtOpenDirectoryObject', 'ioctlsocket', 'UnhookWindowsHookEx', 'InternetOpenUrlW', 'getaddrinfo', 'Module32NextW', 'HttpSendRequestW', 'NtSetInformationFile', 'GetInterfaceInfo', 'CreateServiceW', 'GetFileType', 'CoInitializeEx', 'NtDeviceIoControlFile', 'GetSystemDirectoryW', 'RegQueryValueExW', 'RemoveDirectoryA', 'GetFileAttributesExW', 'RegQueryInfoKeyW', 'getsockname', 'NtOpenKey', 'GlobalMemoryStatusEx', 'WNetGetProviderNameW', 'CreateRemoteThread', 'RemoveDirectoryW', 'GetAdaptersInfo', 'NtQueryKey', 'InternetConnectA', 'ControlService', 'RegOpenKeyExW', 'GetAsyncKeyState', 'PRF', 'FindResourceA', 'CreateDirectoryW', 'NtProtectVirtualMemory', 'SHGetFolderPathW', 'GetSystemWindowsDirectoryW', 'GetUserNameExW', 'CryptCreateHash', 'ReadCabinetState', 'CryptGenKey', 'DeleteUrlCacheEntryW', 'RegEnumKeyExA', 'ReadProcessMemory', 'CryptProtectData', 'DeleteService', 'CertOpenStore', 'NtOpenThread', 'NtCreateKey', 'CopyFileA', 'NtDuplicateObject', 'NtQueryFullAttributesFile', 'Thread32First', 'NetGetJoinInformation', 'InternetOpenW', 'timeGetTime', 'ExitWindowsEx', 'CreateActCtxW', 'OleInitialize', 'InternetCrackUrlW', 'RegDeleteKeyW', 'connect', 'SetStdHandle', 'LdrUnloadDll', 'MessageBoxTimeoutA', 'SetUnhandledExceptionFilter', 'system', 'NtLoadDriver', 'Process32NextW', 'SetWindowsHookExW', 'SetEndOfFile', 'NtCreateMutant', 'NtOpenProcess', 'SHGetSpecialFolderLocation', 'CreateThread', 'GetFileAttributesW', 'CryptDecrypt']

network = ['udp', 'irc', 'http', 'smtp', 'tcp', 'hosts', 'dns', 'domains', 'icmp']

summary = ['fetches_url', 'regkey_read', 'regkey_deleted', 'dll_loaded', 'directory_enumerated', 'file_read', 'file_deleted', 'resolves_host', 'directory_created', 'wmi_query', 'file_moved', 'file_created', 'directory_removed', 'file_opened', 'file_failed', 'regkey_written', 'guid', 'regkey_opened', 'file_exists', 'file_recreated', 'command_line', 'file_copied', 'file_written', 'mutex', 'connects_ip', 'tls_master', 'connects_host']

feature_names = ['duration'] + network + ['dropped'] + api_categories + summary + ['processes'] + api_stats_list

api_info_dict = {'NtCreateSection': 'process', 'InternetGetConnectedStateExA': 'network', 'LoadStringA': 'ui', 'NtReadFile': 'file', 'DrawTextExA': 'ui', 'WriteConsoleW': 'misc', 'GetBestInterfaceEx': 'network', 'FindResourceExW': 'resource', 'RegQueryValueExA': 'registry', 'CopyFileW': 'file', 'DeleteFileW': 'file', 'DrawTextExW': 'ui', 'CreateServiceA': 'services', 'OpenServiceA': 'services', 'GetVolumeNameForVolumeMountPointW': 'file', 'GetAdaptersAddresses': 'network', 'WriteConsoleA': 'misc', 'CryptProtectMemory': 'crypto', 'WSAStartup': 'network', 'RegSetValueExW': 'registry', 'sendto': 'network', 'CertOpenSystemStoreA': 'certificate', 'NtDeleteValueKey': 'registry', 'SizeofResource': 'resource', 'InternetGetConnectedState': 'network', 'CryptExportKey': 'crypto', 'StartServiceW': 'services', 'EnumServicesStatusA': 'services', 'SearchPathW': 'file', 'NtWriteFile': 'file', 'CoGetClassObject': 'ole', 'CreateProcessInternalW': 'process', 'NtFreeVirtualMemory': 'process', 'UuidCreate': 'misc', 'NtAllocateVirtualMemory': 'process', 'SetFileTime': 'file', 'CreateRemoteThreadEx': 'process', 'InternetQueryOptionA': 'network', 'GetKeyboardState': 'system', 'GetForegroundWindow': 'ui', 'CertCreateCertificateContext': 'certificate', 'DnsQuery_W': 'network', 'HttpSendRequestA': 'network', 'RegEnumKeyW': 'registry', 'RegEnumKeyExW': 'registry', 'NtCreateFile': 'file', 'RegDeleteValueA': 'registry', 'FindWindowExA': 'ui', 'Process32FirstW': 'process', 'GetTimeZoneInformation': 'misc', 'RtlCreateUserThread': 'process', 'SetErrorMode': 'system', 'CreateJobObjectW': 'process', 'RtlDecompressBuffer': 'system', 'CoInitializeSecurity': 'ole', 'NtSetValueKey': 'registry', 'SendNotifyMessageW': 'system', 'InternetCrackUrlA': 'network', 'CryptDecodeObjectEx': 'crypto', 'RegisterHotKey': 'misc', 'NtDeleteKey': 'registry', '__exception__': '__notification__', 'InternetOpenA': 'network', 'EnumServicesStatusW': 'services', 'NtEnumerateValueKey': 'registry', 'GetCursorPos': 'misc', 'IWbemServices_ExecQuery': 'misc', 'NtMapViewOfSection': 'process', 'GetFileSizeEx': 'file', 'send': 'network', 'setsockopt': 'network', 'GetSystemTimeAsFileTime': 'synchronisation', 'GetTempPathW': 'file', 'CryptUnprotectMemory': 'crypto', 'NtOpenSection': 'process', 'GetSystemWindowsDirectoryA': 'file', 'recv': 'network', 'SetFileAttributesW': 'file', 'NtUnmapViewOfSection': 'process', 'NtSuspendThread': 'process', 'GetSystemDirectoryA': 'file', 'SetInformationJobObject': 'process', 'NtSetContextThread': 'process', 'ShellExecuteExW': 'process', 'NtClose': 'system', 'NtWriteVirtualMemory': 'process', 'NtQueryDirectoryFile': 'file', 'CryptHashData': 'crypto', 'InternetSetOptionA': 'network', 'FindWindowA': 'ui', 'FindFirstFileExW': 'file', 'CopyFileExW': 'file', 'IsDebuggerPresent': 'system', 'AssignProcessToJobObject': 'process', 'LoadStringW': 'ui', 'WSARecv': 'network', 'LookupPrivilegeValueW': 'system', 'NtQueryMultipleValueKey': 'registry', 'RegDeleteKeyA': 'registry', 'GetDiskFreeSpaceW': 'misc', 'RegCreateKeyExA': 'registry', 'NtOpenMutant': 'synchronisation', 'HttpOpenRequestW': 'network', 'NtQueryAttributesFile': 'file', 'MessageBoxTimeoutW': 'ui', 'GetSystemInfo': 'system', 'NtTerminateProcess': 'process', 'gethostbyname': 'network', 'GetUserNameW': 'misc', 'CoCreateInstance': 'ole', 'GetComputerNameW': 'misc', 'LookupAccountSidW': 'misc', 'NtResumeThread': 'process', 'SetFilePointerEx': 'file', 'HttpOpenRequestA': 'network', 'select': 'network', 'RegEnumValueW': 'registry', 'accept': 'network', 'GetSystemMetrics': 'misc', 'InternetOpenUrlA': 'network', 'WSASocketW': 'network', 'LoadResource': 'resource', 'CryptAcquireContextW': 'crypto', 'closesocket': 'network', 'IWbemServices_ExecMethod': 'misc', 'RegCreateKeyExW': 'registry', 'FindWindowW': 'ui', 'WriteProcessMemory': 'process', 'CreateDirectoryExW': 'file', 'HttpQueryInfoA': 'network', 'OpenSCManagerW': 'services', 'GetUserNameA': 'misc', 'NtGetContextThread': 'process', 'FindWindowExW': 'ui', 'NtQueueApcThread': 'process', 'GetComputerNameA': 'misc', 'RegQueryInfoKeyA': 'registry', 'GetUserNameExA': 'misc', 'GetNativeSystemInfo': 'system', 'LdrLoadDll': 'system', 'NtReadVirtualMemory': 'process', 'RegDeleteValueW': 'registry', 'RegEnumValueA': 'registry', 'GetAddrInfoW': 'network', 'RtlAddVectoredExceptionHandler': 'exception', 'OpenSCManagerA': 'services', 'NetShareEnum': 'netapi', 'listen': 'network', 'RegSetValueExA': 'registry', 'FindResourceExA': 'resource', 'CoCreateInstanceEx': 'ole', 'socket': 'network', 'InternetConnectW': 'network', 'NtQuerySystemInformation': 'system', 'GetFileInformationByHandleEx': 'file', 'CertControlStore': 'certificate', 'ObtainUserAgentString': 'network', 'SetFileInformationByHandle': 'file', 'SetFilePointer': 'file', 'CoUninitialize': 'ole', 'CryptAcquireContextA': 'crypto', 'GetFileVersionInfoSizeExW': 'misc', 'RegCloseKey': 'registry', 'WSASocketA': 'network', 'TaskDialog': 'misc', 'GetDiskFreeSpaceExW': 'misc', 'NetUserGetInfo': 'netapi', 'NtQueryInformationFile': 'file', 'GetFileVersionInfoW': 'misc', 'FindFirstFileExA': 'file', 'WSASendTo': 'network', 'InternetCloseHandle': 'network', 'GetVolumePathNameW': 'file', 'GetFileVersionInfoSizeW': 'misc', 'recvfrom': 'network', 'GetFileInformationByHandle': 'file', 'Module32FirstW': 'process', 'NtQueryValueKey': 'registry', 'OpenServiceW': 'services', 'LdrGetDllHandle': 'system', 'SetWindowsHookExA': 'system', 'NtDelayExecution': 'synchronisation', 'NtCreateThreadEx': 'process', 'GetFileSize': 'file', 'EnumWindows': 'misc', 'NtTerminateThread': 'process', 'RtlAddVectoredContinueHandler': 'exception', 'FindResourceW': 'resource', 'bind': 'network', 'GetFileVersionInfoExW': 'misc', 'GetKeyState': 'system', 'GlobalMemoryStatus': 'system', 'LdrGetProcedureAddress': 'system', 'StartServiceA': 'services', 'SendNotifyMessageA': 'system', 'InternetSetStatusCallback': 'network', 'NtOpenKeyEx': 'registry', 'GetShortPathNameW': 'file', 'Thread32Next': 'process', 'WSARecvFrom': 'network', 'CreateToolhelp32Snapshot': 'process', 'RtlRemoveVectoredExceptionHandler': 'exception', 'NtOpenFile': 'file', 'GetVolumePathNamesForVolumeNameW': 'file', 'OutputDebugStringA': 'system', 'RegOpenKeyExA': 'registry', 'DeviceIoControl': 'file', 'MoveFileWithProgressW': 'file', 'NtEnumerateKey': 'registry', 'shutdown': 'network', 'NtOpenDirectoryObject': 'file', 'ioctlsocket': 'network', 'UnhookWindowsHookEx': 'system', 'InternetOpenUrlW': 'network', 'getaddrinfo': 'network', 'Module32NextW': 'process', 'HttpSendRequestW': 'network', 'NtSetInformationFile': 'file', 'GetInterfaceInfo': 'network', 'CreateServiceW': 'services', 'GetFileType': 'file', 'CoInitializeEx': 'ole', 'NtDeviceIoControlFile': 'file', 'GetSystemDirectoryW': 'file', 'RegQueryValueExW': 'registry', 'RemoveDirectoryA': 'file', 'GetFileAttributesExW': 'file', 'RegQueryInfoKeyW': 'registry', 'getsockname': 'network', 'NtOpenKey': 'registry', 'GlobalMemoryStatusEx': 'system', 'WNetGetProviderNameW': 'network', 'CreateRemoteThread': 'process', 'RemoveDirectoryW': 'file', 'GetAdaptersInfo': 'network', 'NtQueryKey': 'registry', 'InternetConnectA': 'network', 'ControlService': 'services', 'RegOpenKeyExW': 'registry', 'GetAsyncKeyState': 'system', 'PRF': 'crypto', 'FindResourceA': 'resource', 'CreateDirectoryW': 'file', 'NtProtectVirtualMemory': 'process', 'SHGetFolderPathW': 'misc', 'GetSystemWindowsDirectoryW': 'file', 'GetUserNameExW': 'misc', 'CryptCreateHash': 'crypto', 'ReadCabinetState': 'misc', 'CryptGenKey': 'crypto', 'DeleteUrlCacheEntryW': 'network', 'RegEnumKeyExA': 'registry', 'ReadProcessMemory': 'process', 'CryptProtectData': 'crypto', 'DeleteService': 'services', 'CertOpenStore': 'certificate', 'NtOpenThread': 'process', 'NtCreateKey': 'registry', 'CopyFileA': 'file', 'NtDuplicateObject': 'system', 'NtQueryFullAttributesFile': 'file', 'Thread32First': 'process', 'NetGetJoinInformation': 'netapi', 'InternetOpenW': 'network', 'timeGetTime': 'synchronisation', 'ExitWindowsEx': 'system', 'CreateActCtxW': 'misc', 'OleInitialize': 'ole', 'InternetCrackUrlW': 'network', 'RegDeleteKeyW': 'registry', 'connect': 'network', 'SetStdHandle': 'misc', 'LdrUnloadDll': 'system', 'MessageBoxTimeoutA': 'ui', 'SetUnhandledExceptionFilter': 'exception', 'system': 'process', 'NtLoadDriver': 'system', 'Process32NextW': 'process', 'SetWindowsHookExW': 'system', 'SetEndOfFile': 'file', 'NtCreateMutant': 'synchronisation', 'NtOpenProcess': 'process', 'SHGetSpecialFolderLocation': 'misc', 'CreateThread': 'process', 'GetFileAttributesW': 'file', 'CryptDecrypt': 'crypto'} 


################################################################### reduced feature set after feature selection - total 74 ################################################################### 

api_categories =  ['crypto', 'ole', 'ui', 'process', 'file', '__notification__', 'exception', 'registry', 'system', 'synchronisation', 'resource']

api_stats_list =  ['__exception__', 'SearchPathW', 'DrawTextExW', 'FindResourceExW', 'NtQueryDirectoryFile', 'GetSystemMetrics', 'LoadStringW', 'GetFileSizeEx', 'FindResourceW', 'LdrUnloadDll', 'NtQueryAttributesFile', 'CoUninitialize', 'GetFileSize', 'GetFileInformationByHandleEx', 'NtOpenKeyEx', 'NtQueryValueKey', 'GetFileType', 'LdrGetDllHandle', 'NtOpenKey', 'NtAllocateVirtualMemory', 'RegOpenKeyExW', 'RegCloseKey', 'RegQueryValueExW', 'GetSystemTimeAsFileTime', 'NtClose', 'NtMapViewOfSection', 'GetSystemDirectoryW', 'NtWriteFile', 'NtCreateFile', 'GetFileVersionInfoW', 'NtOpenMutant', 'LdrGetProcedureAddress', 'GetFileAttributesW', 'LoadResource', 'SetFilePointer', 'GetSystemWindowsDirectoryW', 'SizeofResource', 'GetForegroundWindow', 'CoInitializeEx', 'WriteConsoleW', 'GetCursorPos', 'NtReadFile', 'NtCreateSection', 'LdrLoadDll']

network =  ['http', 'tcp', 'icmp', 'dns', 'hosts', 'udp', 'domains']

summary =  ['file_deleted', 'file_opened', 'regkey_written', 'guid', 'directory_enumerated', 'regkey_opened', 'file_read', 'dll_loaded', 'file_exists', 'regkey_read', 'directory_created']

feature_names = ['duration'] + network + api_categories + summary + api_stats_list
